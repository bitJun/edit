<link rel="stylesheet" href="./layui.css">
<div class="mceTmpl">
  <div class="layui-container">  
    <div class="layui-row" style="margin-bottom: 20px;">
      <div class="layui-col-md6">
        <div class="">控件ID</div>
        <input
          id="controlId"
          type="text"
          placeholder="必填项"
          autocomplete="off"
          class="layui-input"
        >
      </div>
      <div class="layui-col-md6">
        <div class="">描述</div>
        <input
          id="controlDesc"
          type="text"
          placeholder="必填项"
          autocomplete="off"
          class="layui-input"
        >
      </div>
    </div>
    <div class="layui-tab">
      <ul class="layui-tab-title">
        <li class="layui-this">固定值</li>
      </ul>
      <div class="layui-tab-content">
        <div class="layui-tab-item layui-show">
          
        </div>
      </div>
    </div>
    <div class="layui-form-item">
      <div class="layui-inline">
        <label class="layui-form-label">值</label>
        <div class="layui-input-inline" style="width: 100px;">
          <input id="key" type="text" autocomplete="off" class="layui-input">
        </div>
      </div>
      <div class="layui-inline">
        <label class="layui-form-label">描述</label>
        <div class="layui-input-inline" style="width: 100px;">
          <input id="value" type="text" autocomplete="off" class="layui-input">
        </div>
      </div>
      <div class="layui-inline">
        <button id="add" type="button" class="layui-btn layui-btn-sm">
          添加
        </button>
      </div>
    </div>
  </div>
  <div style="display: flex;justify-content: flex-end;">
    <button id="sure" type="button" class="layui-btn layui-btn-sm">
      确定
    </button>
    <button id="cancel" type="button" class="layui-btn layui-btn-sm">
      取消
    </button>
  </div>
</div>
<script src="./jquery.js"></script>
<script src="./layui.js"></script>
<script>
  let data = [];
  $(document).ready(function(){
    window.parent.document.getElementsByClassName('tox-dialog__footer')[0].setAttribute('style', 'display: none');
    $('#add').click(function(){
      let key = $('#key').val();
      let value = $('#value').val();
      let html = `<div>${key}  ${value}</div>`;
      data.push({
        key: key,
        value: value,
      });
      $('.layui-show').append(html);
    });
    $('#sure').click(function(){
      let id = $('#controlId').val();
      let desc = $('#controlDesc').val();
      let str = ``;
      str += `<div style="display:flex" id="${id}"><label>${desc}</label>`;
      data.forEach(item=>{
        str+=`<div><input type="checkbox" name="${id}" data-value="${item.key}" />${item.value}</div>`;
      })
      str += `</div>`;
      window.parent.tinyMCE.activeEditor.setContent(str);
      window.parent.document.getElementsByClassName('tox-dialog-wrap')[0].remove();
      window.parent.document.getElementsByClassName('tox-dialog')[0].remove();
    });
    $('#cancel').click(function(){
      window.parent.document.getElementsByClassName('tox-dialog-wrap')[0].remove();
      window.parent.document.getElementsByClassName('tox-dialog')[0].remove();
    });
  })
  // document.getElementById("ddd").addEventListener("click", function(){
  //   window.parent.tinyMCE.activeEditor.setContent('草泥马测试');
  // });
</script>